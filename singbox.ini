;===============================================================
; Sing-box 专用配置 - 基于原 Clash 规则改编
; 适配订阅转换：https://github.com/imzyb/MiSub
; 使用方式：SubConverter 配置文件 URL 填写此文件地址
;===============================================================

[custom]

;================= 规则部分（规则顺序很重要！）=================

; === 第 1 优先级：基础规则 ===
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/UnBan.list

; === 第 2 优先级：广告拦截 ===
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising.yaml
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Privacy/Privacy.yaml
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Hijacking/Hijacking.yaml

; === 第 3 优先级：专用应用规则 ===

; ---------- ChatGPT / OpenAI ----------
ruleset=ChatGPT,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml
ruleset=ChatGPT,[]DOMAIN-SUFFIX,anthropic.com
ruleset=ChatGPT,[]DOMAIN-SUFFIX,claude.ai
ruleset=ChatGPT,[]DOMAIN-SUFFIX,genspark.ai
ruleset=ChatGPT,[]DOMAIN-SUFFIX,perplexity.ai
ruleset=ChatGPT,[]DOMAIN-SUFFIX,pplx.ai
ruleset=ChatGPT,[]DOMAIN-SUFFIX,midjourney.com
ruleset=ChatGPT,[]DOMAIN-SUFFIX,deepl.com
ruleset=ChatGPT,[]DOMAIN-SUFFIX,notion.so
ruleset=ChatGPT,[]DOMAIN-SUFFIX,character.ai
ruleset=ChatGPT,[]DOMAIN-SUFFIX,huggingface.co
ruleset=ChatGPT,[]DOMAIN-SUFFIX,cursor.sh
ruleset=ChatGPT,[]DOMAIN-SUFFIX,runwayml.com
ruleset=ChatGPT,[]DOMAIN,gemini.google.com
ruleset=ChatGPT,[]DOMAIN,bard.google.com
ruleset=ChatGPT,[]DOMAIN,copilot.microsoft.com
ruleset=ChatGPT,[]DOMAIN-KEYWORD,openai
ruleset=ChatGPT,[]DOMAIN-KEYWORD,chatgpt
ruleset=ChatGPT,[]DOMAIN-KEYWORD,claude
ruleset=ChatGPT,[]DOMAIN-KEYWORD,genspark
ruleset=ChatGPT,[]DOMAIN-KEYWORD,gemini

; ---------- TikTok ----------
ruleset=TikTok,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/TikTok/TikTok.yaml

; ---------- YouTube ----------
ruleset=油管视频,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml

; ---------- Netflix / HBO Max ----------
ruleset=奈飞视频,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml
ruleset=奈飞视频,[]DOMAIN-SUFFIX,hbomax.com
ruleset=奈飞视频,[]DOMAIN-SUFFIX,max.com
ruleset=奈飞视频,[]DOMAIN-SUFFIX,hbo.com

; ---------- 香港流媒体 ----------
ruleset=香港流媒体,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/myTVSUPER/myTVSUPER.yaml
ruleset=香港流媒体,[]DOMAIN-SUFFIX,tvb.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,tvbanywhere.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,bigbigchannel.com.hk

; ---------- Telegram ----------
ruleset=电报消息,[]IP-CIDR,91.108.0.0/16,no-resolve
ruleset=电报消息,[]IP-CIDR,149.154.0.0/16,no-resolve
ruleset=电报消息,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml

; === 第 4 优先级：苹果服务 ===
ruleset=苹果服务,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list

; === 第 5 优先级：GFW 列表 ===
ruleset=节点选择,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list

; === 第 6 优先级：中国大陆直连 ===
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
ruleset=全球直连,[]GEOIP,CN,no-resolve

; === 第 7 优先级：兜底规则 ===
ruleset=漏网之鱼,[]FINAL


;================= 策略组部分（Sing-box 格式）=================

; === 主选择策略组 ===
custom_proxy_group=节点选择`select`[]AWS香港负载`[]AWS台湾负载`[]新加坡负载`[]香港负载`[]美国负载`[]澳门负载`[]AWS东京负载`[]自动选择`[]故障转移`[]DIRECT`.*

; === 自动测速组 ===
custom_proxy_group=自动选择`url-test`.*`http://www.gstatic.com/generate_204`600`50
custom_proxy_group=故障转移`fallback`.*`http://www.gstatic.com/generate_204`600`50

; === 负载均衡组 ===

; 美国负载
custom_proxy_group=美国负载`url-test`(洛杉矶|aws洛|美国|US|USA|America|United|us|usa)`http://www.gstatic.com/generate_204`600`80

; 澳门负载
custom_proxy_group=澳门负载`url-test`(澳门|澳門|debee|Jdebee|Macao|Macau|macao)`http://www.gstatic.com/generate_204`480`80

; 新加坡负载
custom_proxy_group=新加坡负载`url-test`(新加坡|SG|Singapore|狮城|sg|singapore)`http://www.gstatic.com/generate_204`360`50

; 香港负载
custom_proxy_group=香港负载`url-test`(香港电视|HK电视|TVB|mytv|MyTV)`http://www.gstatic.com/generate_204`480`60

; AWS 香港负载
custom_proxy_group=AWS香港负载`url-test`(aws香港|AWS香港|aws-hk|AWS-HK)`http://www.gstatic.com/generate_204`600`40

; AWS 台湾负载
custom_proxy_group=AWS台湾负载`url-test`(aws台湾|AWS台湾|aws-tw|AWS-TW)`http://www.gstatic.com/generate_204`600`40

; AWS 东京负载
custom_proxy_group=AWS东京负载`url-test`(aws东京|东京|Tokyo|JP|日本|tokyo|jp|japan|AWS东京)`http://www.gstatic.com/generate_204`360`50

; === 应用专用策略组 ===

; ChatGPT / AI 服务
custom_proxy_group=ChatGPT`select`[]美国负载`[]新加坡负载`[]AWS东京负载`[]AWS台湾负载`[]节点选择`[]自动选择`[]DIRECT`(洛杉矶|美国|US)`.*

; TikTok
custom_proxy_group=TikTok`select`[]美国负载`[]新加坡负载`[]AWS东京负载`[]AWS台湾负载`[]节点选择`[]自动选择`(洛杉矶|美国|US|新加坡|SG)`.*

; Netflix / HBO Max
custom_proxy_group=奈飞视频`select`[]美国负载`[]AWS东京负载`[]新加坡负载`[]节点选择`[]自动选择`(洛杉矶|美国|US)`.*

; YouTube
custom_proxy_group=油管视频`select`[]澳门负载`[]美国负载`[]AWS东京负载`[]AWS香港负载`[]AWS台湾负载`[]节点选择`[]自动选择`(澳门|debee)`.*

; 香港流媒体
custom_proxy_group=香港流媒体`select`[]澳门负载`[]香港负载`[]AWS香港负载`(香港电视|TVB|mytv)`[]节点选择`[]自动选择

; Telegram
custom_proxy_group=电报消息`select`[]新加坡负载`[]节点选择`[]自动选择

; 苹果服务
custom_proxy_group=苹果服务`select`[]DIRECT`[]节点选择`[]自动选择

; 广告拦截
custom_proxy_group=广告拦截`select`[]REJECT`[]DIRECT

; 全球直连
custom_proxy_group=全球直连`select`[]DIRECT`[]节点选择

; 漏网之鱼
custom_proxy_group=漏网之鱼`select`[]节点选择`[]AWS香港负载`[]AWS台湾负载`[]新加坡负载`[]香港负载`[]美国负载`[]澳门负载`[]自动选择`[]DIRECT`.*


;================= Sing-box 特殊配置 =================
enable_rule_generator=true
overwrite_original_rules=true

; Sing-box 专用设置
singbox_route_mode=rule
singbox_mixed_port=7890
singbox_tun_enabled=true
singbox_tun_stack=mixed
