;===============================================================
; ACL4SSR + blackmatrix7 混合规则 - 极致精简自动更新版
; 优化：OpenAI、TikTok、myTVSUPER、广告拦截使用 blackmatrix7
; 特点：规则精简、每日自动更新、性能优异
;===============================================================

;================= 规则部分 =================

; === 基础规则（ACL4SSR）===
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/UnBan.list

; === 广告/隐私/劫持拦截（blackmatrix7 三合一）===
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising.yaml
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Privacy/Privacy.yaml
ruleset=广告拦截,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Hijacking/Hijacking.yaml

; === AI 服务（blackmatrix7 + 手动补充）===
ruleset=ChatGPT,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml
ruleset=ChatGPT,[]DOMAIN-SUFFIX,anthropic.com
ruleset=ChatGPT,[]DOMAIN-SUFFIX,claude.ai
ruleset=ChatGPT,[]DOMAIN-KEYWORD,claude

; === 流媒体服务（blackmatrix7 自动更新）===
ruleset=TikTok,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/TikTok/TikTok.yaml
ruleset=奈飞视频,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml
ruleset=油管视频,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml
ruleset=香港流媒体,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/myTVSUPER/myTVSUPER.yaml
ruleset=电报消息,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml

; === 苹果服务（ACL4SSR）===
ruleset=苹果服务,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list

; === GFW 翻墙列表（放在后面，避免覆盖）===
ruleset=节点选择,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list

; === 中国大陆直连（ACL4SSR）===
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
ruleset=全球直连,[]GEOIP,CN,no-resolve

; === 兜底规则 ===
ruleset=漏网之鱼,[]FINAL


;================= 策略组部分 =================

; === 主选择策略组 ===
custom_proxy_group=节点选择`select`[]美国负载`[]澳门负载`[]新加坡负载`[]香港负载`[]AWS香港负载`[]AWS台湾负载`[]AWS东京负载`[]自动选择`[]故障转移`[]DIRECT`.*

; === 自动测速组 ===
custom_proxy_group=自动选择`url-test`.*`https://www.cloudflare.com/cdn-cgi/trace`240,,50
custom_proxy_group=故障转移`fallback`.*`https://www.cloudflare.com/cdn-cgi/trace`240,,50

; === 负载均衡组（区域分组）===

; 美国负载
custom_proxy_group=美国负载`load-balance`(?!.*(澳门|澳門|debee|香港.*电视|电视|东京|台湾|台灣|新加坡|SG)).*(美国|美國|US|USA|America|United|States|Los.*Angeles|Ohio|洛杉矶)`https://www.cloudflare.com/cdn-cgi/trace`240,,80

; 澳门负载
custom_proxy_group=澳门负载`load-balance`(?!.*(香港.*电视|电视|美国|US)).*(澳门|澳門|debee|Jdebee|Macao|Macau)`https://www.youtube.com/generate_204`180,,80

; 新加坡负载
custom_proxy_group=新加坡负载`load-balance`(?!.*(澳门|debee|香港.*电视|电视|东京|美国|US)).*(新加坡|SG|Singapore|狮城|Aliyun|aws.*新加坡|AWS.*SG)`https://www.cloudflare.com/cdn-cgi/trace`120,,50

; 香港负载
custom_proxy_group=香港负载`load-balance`(?!.*(澳门|debee|美国|US)).*(香港.*电视|香港电视|HK.*电视|HK.*TV|电视)`https://www.cloudflare.com/cdn-cgi/trace`180,,60

; AWS 香港负载
custom_proxy_group=AWS香港负载`load-balance`(?!.*(澳门|debee|电视|东京|台湾|新加坡|美国)).*(aws.*香港.*hy2|AWS.*HK.*hy2|aws.*hk.*hy2|aws-HK|AWS-HK)`https://www.cloudflare.com/cdn-cgi/trace`240,,40

; AWS 台湾负载
custom_proxy_group=AWS台湾负载`load-balance`(?!.*(澳门|debee|电视|东京|香港|新加坡|美国)).*(台湾.*hy2|台灣.*hy2|TW.*hy2|Taiwan.*hy2|aws.*台湾|aws.*TW|aws-TW|AWS-TW)`https://www.cloudflare.com/cdn-cgi/trace`240,,40

; AWS 东京负载
custom_proxy_group=AWS东京负载`load-balance`(?!.*(澳门|debee|电视|美国|US)).*(aws东京|AWS东京|aws.*东京|东京.*aws|Tokyo.*AWS|JP.*AWS|aws.*tokyo|aws-JP|AWS-JP|东京)`https://www.cloudflare.com/cdn-cgi/trace`120,,50

; === 应用专用策略组 ===

; ChatGPT - 美国优先
custom_proxy_group=ChatGPT`select`[]美国负载`[]新加坡负载`[]AWS东京负载`[]AWS香港负载`[]AWS台湾负载`[]节点选择`[]自动选择

; TikTok - 美国优先
custom_proxy_group=TikTok`select`[]美国负载`[]新加坡负载`[]AWS东京负载`[]AWS香港负载`[]节点选择`[]自动选择

; Netflix - 美国优先
custom_proxy_group=奈飞视频`select`[]美国负载`[]AWS东京负载`[]AWS香港负载`[]新加坡负载`[]节点选择`[]自动选择`(美国|US|Netflix|NF|奈飞)`.*

; YouTube - 澳门优先（大带宽）
custom_proxy_group=油管视频`select`[]澳门负载`[]美国负载`[]AWS东京负载`[]AWS香港负载`[]节点选择`[]自动选择`(澳门|debee)`.*

; 香港流媒体 - 香港电视专线
custom_proxy_group=香港流媒体`select`[]香港负载`[]AWS香港负载`(香港.*电视|电视)`[]节点选择`[]自动选择

; Telegram - 新加坡优先（低延迟）
custom_proxy_group=电报消息`select`[]新加坡负载`[]美国负载`[]AWS东京负载`[]AWS香港负载`[]节点选择`[]自动选择

; 苹果服务 - 直连优先
custom_proxy_group=苹果服务`select`[]DIRECT`[]节点选择`[]自动选择

; 广告拦截
custom_proxy_group=广告拦截`select`[]REJECT`[]DIRECT

; 全球直连
custom_proxy_group=全球直连`select`[]DIRECT`[]节点选择

; 漏网之鱼 - 节点选择优先
custom_proxy_group=漏网之鱼`select`[]节点选择`[]美国负载`[]澳门负载`[]自动选择`[]DIRECT`.*


;================= 规则生成器设置 =================
enable_rule_generator=true
overwrite_original_rules=true
