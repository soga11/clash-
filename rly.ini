;不要随意改变关键字,否则会导致出错
;ACL4SSR 在线规则配置 - 极致性能版（修复新加坡匹配）
;无节点数量限制 + 精准测速 + 移动宽带优化

;================= 规则部分 =================

; 基础直连/解锁
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/UnBan.list

; 广告 / 垃圾规则
ruleset=广告拦截,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list
ruleset=应用净化,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanProgramAD.list

; 香港流媒体（myTVsuper）
ruleset=香港流媒体,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/HWTV.list
ruleset=香港流媒体,[]DOMAIN-SUFFIX,mytvsuper.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,tvb.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,tvbanywhere.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,tvbusa.com
ruleset=香港流媒体,[]DOMAIN-SUFFIX,bigbigchannel.com.hk
ruleset=香港流媒体,[]DOMAIN-SUFFIX,encoretvb.com
ruleset=香港流媒体,[]DOMAIN-KEYWORD,mytvsuper
ruleset=香港流媒体,[]DOMAIN-KEYWORD,tvb

; YouTube
ruleset=油管视频,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/YouTube.list

; Telegram
ruleset=电报消息,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Telegram.list

; Netflix
ruleset=奈飞视频,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Netflix.list

; TikTok
ruleset=TikTok,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/TikTok.list

; ChatGPT / AI
ruleset=ChatGPT,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/OpenAI.list
ruleset=ChatGPT,[]DOMAIN-SUFFIX,anthropic.com
ruleset=ChatGPT,[]DOMAIN-SUFFIX,claude.ai
ruleset=ChatGPT,[]DOMAIN-KEYWORD,claude

; 苹果服务
ruleset=苹果服务,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list

; 其他翻墙网站 / GFW 列表
ruleset=节点选择,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list

; 大陆直连相关
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
ruleset=全球直连,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Download.list

; 大陆 IP 直连
ruleset=全球直连,[]GEOIP,CN,no-resolve

; 兜底:漏网之鱼
ruleset=漏网之鱼,[]FINAL


;================= 策略组部分（修复新加坡匹配）=================

; 总节点池 - 手动选择
custom_proxy_group=节点选择`select`[]澳门负载`[]新加坡负载`[]香港负载`[]AWS香港负载`[]AWS台湾负载`[]AWS东京负载`[]自动选择`[]故障转移`[]DIRECT`.*

; 自动选择 - 延迟最低（Cloudflare 稳定测速）
custom_proxy_group=自动选择`url-test`.*`https://www.cloudflare.com/cdn-cgi/trace`240,,50

; 故障转移组（Cloudflare 稳定测速）
custom_proxy_group=故障转移`fallback`.*`https://www.cloudflare.com/cdn-cgi/trace`240,,50

; === 极致性能负载均衡组（修复新加坡匹配）===

; AWS 香港 hy2 负载均衡组
; 规则: 匹配包含 "香港" 或 "HK" 的 hy2 节点
; 排除: 澳门、debee、东京、台湾、新加坡等其他地区标识
custom_proxy_group=AWS香港负载`load-balance`(?!.*(澳门|澳門|debee|东京|Tokyo|台湾|台灣|TW|新加坡|SG)).*(aws.*香港.*hy2|AWS.*香港.*HY2|aws.*HK.*hy2|HK.*AWS.*hy2|香港.*aws.*hy2|aws.*hk.*hy2|aws-HK|AWS-HK)`https://www.cloudflare.com/cdn-cgi/trace`240,,40

; AWS 台湾 hy2 负载均衡组
; 规则: 匹配包含 "台湾" 或 "TW" 的 hy2 节点
; 排除: 澳门、debee、东京、香港、新加坡等其他地区标识
custom_proxy_group=AWS台湾负载`load-balance`(?!.*(澳门|澳門|debee|东京|Tokyo|香港|HK|新加坡|SG)).*(台湾.*hy2|台灣.*hy2|TW.*hy2|Taiwan.*hy2|aws.*台湾.*hy2|AWS.*TW.*hy2|aws.*tw.*hy2|aws-TW|AWS-TW)`https://www.cloudflare.com/cdn-cgi/trace`240,,40

; AWS 东京负载均衡组
; 规则: 匹配所有 "aws东京" 开头的节点
; 排除: 只排除包含服务标识的节点（澳门、debee、香港电视）
; 保留: 所有东京主机节点（nazm, anna, qu923, kilo.新加坡bzvm 等）
custom_proxy_group=AWS东京负载`load-balance`(?!.*(澳门|澳門|debee|香港.*电视|香港.*TV|HK.*电视|HK.*TV)).*(aws东京|AWS东京|aws.*东京|AWS.*东京|东京.*aws|Tokyo.*AWS|JP.*AWS|aws.*tokyo|AWS.*Tokyo|aws-JP|AWS-JP)`https://www.cloudflare.com/cdn-cgi/trace`120,,50

; 香港电视负载均衡组
; 规则: 明确匹配包含 "香港电视" 或 "HK电视" 的节点
; 包括: aws东京bbyy44香港电视（东京主机，香港电视服务）
custom_proxy_group=香港负载`load-balance`(香港.*电视|香港-电视|HK.*电视|HK.*TV|香港.*TV|.*香港电视|bbyy44.*香港电视|东京.*香港电视)`https://www.cloudflare.com/cdn-cgi/trace`180,,60

; 澳门 debee 负载均衡组
; 规则: 匹配包含 "澳门" 和 "debee" 的节点（无论前面是什么地区）
; 包括: aws东京kilo.澳门debee, aws东京bbyy44me.s-ui澳门Jdebee
custom_proxy_group=澳门负载`load-balance`(澳门.*debee|澳門.*debee|MO.*debee|Macao.*debee|Macau.*debee|.*澳门.*debee|.*澳門.*debee|东京.*澳门.*debee)`https://www.youtube.com/generate_204`180,,80

; 新加坡负载均衡组（修复：放宽匹配规则）
; 规则: 匹配包含 "新加坡" 或 "SG" 或 "Singapore" 的节点
; 排除: aws东京开头的节点（避免匹配东京主机的新加坡线路名）
custom_proxy_group=新加坡负载`load-balance`(?!.*(aws东京|AWS东京|aws.*东京|东京)).*(新加坡|SG|Singapore|狮城|^aws.*新加坡|^AWS.*SG|aws.*sg|AWS.*sg)`https://www.cloudflare.com/cdn-cgi/trace`120,,50

; === 应用专用策略组（绑定最佳线路）===

; 香港流媒体 - 香港电视专线优先
custom_proxy_group=香港流媒体`select`[]香港负载`[]AWS香港负载`(香港.*电视|香港-电视|HK.*电视|bbyy44.*香港电视|东京.*香港电视)`[]节点选择`[]自动选择`[]DIRECT`.*

; YouTube - 澳门 debee 专线优先（4K 带宽叠加）
custom_proxy_group=油管视频`select`[]澳门负载`[]AWS东京负载`[]AWS香港负载`[]AWS台湾负载`(澳门.*debee|澳門.*debee|东京.*澳门.*debee)`[]节点选择`[]自动选择`[]DIRECT`.*

; Telegram - 新加坡专线优先（低延迟）
custom_proxy_group=电报消息`select`[]新加坡负载`[]AWS东京负载`[]AWS香港负载`(新加坡|SG)`[]节点选择`[]自动选择`[]DIRECT`.*

; Netflix - AWS 东京优先（日本区 Netflix）
custom_proxy_group=奈飞视频`select`[]AWS东京负载`[]AWS香港负载`[]AWS台湾负载`[]节点选择`[]自动选择`[]故障转移`(NF|奈飞|解锁|Netflix|NETFLIX|Media|流媒体)`.*

; TikTok - 新加坡优先
custom_proxy_group=TikTok`select`[]新加坡负载`[]AWS东京负载`[]AWS香港负载`[]节点选择`[]自动选择`[]故障转移`.*

; ChatGPT - AWS 香港优先
custom_proxy_group=ChatGPT`select`[]AWS香港负载`[]AWS东京负载`[]新加坡负载`[]节点选择`[]自动选择`[]故障转移`.*

; 苹果服务 - 直连优先
custom_proxy_group=苹果服务`select`[]DIRECT`[]节点选择`[]自动选择`.*

; 广告拦截 / 应用净化
custom_proxy_group=广告拦截`select`[]REJECT`[]DIRECT
custom_proxy_group=应用净化`select`[]REJECT`[]DIRECT

; 全球直连
custom_proxy_group=全球直连`select`[]DIRECT`[]节点选择

; 漏网之鱼 - 澳门负载优先
custom_proxy_group=漏网之鱼`select`[]节点选择`[]澳门负载`[]AWS东京负载`[]自动选择`[]故障转移`[]DIRECT`.*


;================= 规则生成器设置 =================

enable_rule_generator=true
overwrite_original_rules=true
